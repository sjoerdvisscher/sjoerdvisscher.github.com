<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Search - w3future.com</title>
  <meta name="author" content="Sjoerd Visscher" />
  <meta name="keywords" content="w3, www, world, wide, web, future, weblog, latest, news, javascript, js, soap, xml, rpc, html, mozilla, internet, explorer, netscape, semantic" />
  <meta name="description" content="My ideas about new web technology that can change the future of the world wide web." />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="author" title="Sjoerd Visscher" href="mailto:sjoerd@w3future.com" />
  <link rel="top" href="http://w3future.com/weblog/" />
  <link rel="icon" href="http://w3future.com/w3f/icon.png" type="image/png" />
  <script type="text/javascript" src="http://w3future.com/w3f/w3f.js"></script>
  <script type='text/javascript'><!--
document.write('<'+'style>@import "http://w3future.com/w3f/w3f.phtml?'+document.cookie+'";<'+'/style>');
//--></script>
  
</head>
<body>
<div id="header">
	<a href="#"></a>
	<div id="header-title-shadow">w3future.com</div>
	<div id="header-title">w3future.com</div>
	<div id="header-tabs">
<div class='tab'><a href='http://w3future.com/weblog/'>Weblog</a></div>
<div class='tab'><a href='http://w3future.com/html/examples.html'>Examples</a></div>
<div class='tab'><a href='http://w3future.com/html/stories/'>Articles</a></div>
<div class='tab'><a href='http://w3future.com/html/download.html'>Downloads</a></div>
</div>
</div>
<div id="layout">
	<div id="sidebar">
<div class='sidebar-header'>What I read</div>
<div class='button2'><a href='http://diveintomark.org/'>Dive into Mark</a></div>
<div class='button2'><a href='http://www.joelonsoftware.com/'>Joel on Software</a></div>
<div class='button2'><a href='http://radio.weblogs.com/0100887/'>Jon Udell</a></div>
<div class='button2'><a href='http://lambda.weblogs.com/'>Lambda the Ultimate</a></div>
<div class='button2'><a href='http://markpasc.org/blog/'>markpasc_blog</a></div>
<div class='button2'><a href='http://radio.weblogs.com/0101679/'>Sam Ruby</a></div>
<div class='button2'><a href='http://www.scripting.com/'>Scripting News</a></div>
<div class='button2'><a href='http://www.xmlhack.com/'>XMLHack</a></div>
<div class='button2'><a href='http://w3future.com/html/weblogsources.html'><b>All sources</b></a></div>
<div class='sidebar-header'>Friends/Family</div>
<div class='button2'><a href='http://joeri.mulder.com/'>Joeri</a></div>
<div class='button2'><a href='http://www.maggerydoo.net/'>Marco</a></div>
<div class='button2'><a href='http://uitdeschaduw.blogspot.com/'>Jelle</a></div>
<div class='button2'><a href='http://www.q42.nl/'>Q42</a></div>
</div>
	<div id="content">
		<h1>Search</h1>
		<p>Using Google through XooMLe</p>
		<div id="note"><h3>Linking</h3><p>For each search request the URL is automatically updated. If you want to link to specific search result you can use that URL.</p>
			<h3>Last Update</h3>
			<p>9/7/2002; 3:48:54 PM</p>
		</div>
		<script type="text/javascript"><!--
		var xoomleUrl='';
		function doSearch(text) {
			if (!text) {
				text=document.forms['loader'].url.value;
			} else {
				document.forms['loader'].url.value=text;
			}
			try {
				location.replace('http://w3future.com/html/search.html#'+text);
			} catch(e) {}
			var s=new w3f_XMLDocument();
			s.onload=function () {
				if (this.documentElement.nodeName=='!error') {
					alert('Error parsing '+this.url+' at line '+this.documentElement.attributes.line+': '+this.documentElement.attributes.code);
					return;
				}
				var result=this.getSimpleTree().GoogleSearchResult;
				var html='';
				try {
				if (result.resultElements) {
					var results=result.resultElements.item;
					var j=0;
					if (result.startIndex>0) {
						for (var i=0;i<=result.endIndex-result.startIndex;i++) {
							try{
								var res=results[i];
								if (!res) continue;
								var url=''+res.URL;
								if (url=='http:/'+'/w3future.com/weblog/') continue;
								var title=res.title['#text']||url;
								var m=url.match(/(\d{4})\/(\d{2})\/(\d{2})/);
								if (m&&url.indexOf('w3future.com')!=-1) {
									var d=new Date(m[1],m[2]-1,m[3]);
									title=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'][d.getDay()]+', '+
										['January','February','March','April','May','June','July','August','September','October','November','December'][d.getMonth()]+' '+
										d.getDate()+', '+d.getFullYear();
								}
								html+='<h3><a href="'+url+'">'+title+'</a></h3>';
								if (res.snippet['#text'])
									html+='<blockquote><p>'+res.snippet+'</p></blockquote>';
								html+='<p>'+url+' - <span style="cursor:pointer;cursor:hand;text-decoration:underline" onclick="doSearch(\'link:'+url+'\');" title="Show which sites link to this page">links to this page</span></p>';
							} catch(e) {alert(e.message)}
						}
					}
				}
				} catch(e) {alert(e.message)}
				try {if (result.errorString) html+="<h3>Error: "+result.errorString+"</h3>";} catch(e) {alert(e.message)}
				if (!html) html="<h3>No results found</h3>";
				html+='<p><a href="http://www.google.com/search?q='+escape(text)+'">Same search with Google\'s interface.</a></p>';
				html+='<p><a href="'+xoomleUrl+'"><img src="http://radio.weblogs.com/0100323/images/xml.gif" width="36" height="14" alt="[XML]" /> This result in XML format.</a></p>';
				document.getElementById('OPMLDiv').innerHTML=html;
			};
			document.getElementById('OPMLDiv').innerHTML='Searching...';
			if (text.indexOf('link:')!=0) {
				text+=" site:w3future.com";
				xoomleUrl='http:/'+'/xoomle.dentedreality.com.au/search/?key=6ycnFAZiVyxI5J5Xu%2B9s6zlKNGx5au02&maxResults=20&filter=0&safeSearch=0&q='+escape(text);
			} else {
				xoomleUrl='http:/'+'/xoomle.dentedreality.com.au/search/?key=6ycnFAZiVyxI5J5Xu%2B9s6zlKNGx5au02&maxResults=20&filter=1&safeSearch=1&q='+escape(text);
			}
			s.load(xoomleUrl);
		}		
		 
		function fixText(s) {
			return s.replace(/</g,'&lt;');
		}
		
		function err(e,s) {
		  for (var i in e) {
		    s+='\n'+i+': '+e[i];
		  }
		  alert(s);
		}
		
		function loadHash() {
			var h=location.hash;
			if (h.length<2) return;
			h=h.substr(1);
			document.forms['loader'].url.value=h;
			doSearch(h);
		}
		document.body.setAttribute("onload","loadHash()");
		document.body.onload=new Function("", "loadHash()");
		
	//-->
	</script>		
<h2>Enter search terms</h2>
<form onsubmit="doSearch();return false;" id="loader" action="">
<p><input type="text" style="width:80%" name="url" value="" /></p>
<div style="width:15em"><script type="text/javascript">document.write(createButton({style:'button',content:'Search',action:"doSearch()"}))</script></div>
</form>
<h2>Result</h2>
<div id="OPMLDiv"></div>
<h2>Technical Details</h2>
<p>I could not have made this page without <a href="http://www.dentedreality.com.au/xoomle/">XooMLe</a>.
It allows me to simply retrieve <a href="http://www.google.com">Google</a> results in XML from a constructed url.
This data is parsed at the server and sent to the browser in an iframe.
The results are then converted to html on the client and inserted in the page.
</p>
<script src="/tools/xmlload.js" type="text/javascript"></script>
<script src="/tools/xmlrpc.js" type="text/javascript"></script>
</div>
	<div id="footer">&#x00A9; Copyright 2002 <a href="mailto:sjoerd@w3future.com">Sjoerd Visscher</a>, <a href="http://w3future.com/">w3future.com</a></div>
</div>
<script type='text/javascript'><!--
initButtons(true);initSectionTabs();initSidebarButtons();staticSiteStatsImage()
//--></script>
</body>
</html>
