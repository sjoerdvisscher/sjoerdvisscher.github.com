<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Loell - w3future.com</title>
  <meta name="author" content="Sjoerd Visscher" />
  <meta name="keywords" content="w3, www, world, wide, web, future, weblog, latest, news, javascript, js, soap, xml, rpc, html, mozilla, internet, explorer, netscape, semantic" />
  <meta name="description" content="My ideas about new web technology that can change the future of the world wide web." />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="author" title="Sjoerd Visscher" href="mailto:sjoerd@w3future.com" />
  <link rel="top" href="http://w3future.com/weblog/" />
  <link rel="icon" href="http://w3future.com/w3f/icon.png" type="image/png" />
  <script type="text/javascript" src="http://w3future.com/w3f/w3f.js"></script>
  <script type='text/javascript'><!--
document.write('<'+'style>@import "http://w3future.com/w3f/w3f.phtml?'+document.cookie+'";<'+'/style>');
//--></script>
  
</head>
<body>
<div id="header">
	<a href="#"></a>
	<div id="header-title-shadow">w3future.com</div>
	<div id="header-title">w3future.com</div>
	<div id="header-tabs">
<div class='tab'><a href='http://w3future.com/weblog/'>Weblog</a></div>
<div class='tab'><a href='http://w3future.com/html/examples.html'>Examples</a></div>
<div class='tab'><a href='http://w3future.com/html/stories/'>Articles</a></div>
<div class='tab'><a href='http://w3future.com/html/download.html'>Downloads</a></div>
</div>
</div>
<div id="layout">
	<div id="sidebar">
<div class='sidebar-header'>My ultimate resource</div>
<div class='button2'><a href='http://lambda.weblogs.com/'>Lambda the Ultimate</a></div>
<div class='sidebar-header'>Inspiring Languages</div>
<div class='button2'><a href='http://www.cs.arizona.edu/icon/'>Icon</a></div>
<div class='button2'><a href='http://www.ecma.ch/STAND/Ecma-262.htm'>Javascript</a></div>
<div class='button2'><a href='http://www.lisp.org/'>Lisp</a></div>
<div class='button2'><a href='http://www.lua.org/'>Lua</a></div>
<div class='button2'><a href='http://www.mozart-oz.org/'>Mozart</a></div>
<div class='button2'><a href='http://www.iam.unibe.ch/~scg/Research/Piccola/'>Piccola</a></div>
<div class='button2'><a href='http://www.swi-prolog.org/'>Prolog</a></div>
<div class='button2'><a href='http://www.ruby-lang.org/en/'>Ruby</a></div>
</div>
	<div id="content">
		<h1>Loell</h1>
		<p>lazy object evaluation little language</p>
		<div id="note">
			<h3>Last Update</h3>
			<p>1/9/2003; 1:42:22 AM</p>
		</div>
	<script src="loell_core.js" type="text/javascript"></script>
<script src="loell_parser.js" type="text/javascript"></script>
<script type="text/javascript"><!--
function debug(s) {
	document.getElementById('result').innerHTML = code;
	alert(s);
}
function run() {
	var source = document.getElementById('source').value;
	var tokens = tokenize(source);
	document.getElementById('result').innerHTML = tokens.join(' ');
//	try {
		code = new Parser().parse(tokens);
//	} catch(e) {return}
	document.getElementById('result').innerHTML = code;
	try {
		var value = code.e(getGlobal());
		if (ISA(value,LoellFailure)&&value!=LoellFailure)
			alert(value);
		else document.getElementById('result').innerHTML = (''+value).replace(/\n/g,'<br/>');
	} catch(e) {
		alert('javascript error: '+e.message||e);
	}
}
--></script>
<style type="text/css"><!--
td {vertical-align:top}
th {text-align:left}
#result div {margin-left:1em;font-family:monospace}
#result {color:black;background:white;font-family:monospace;padding:0em 0.2em}
--></style>
<p>Loell is an experimental programming language in development. 
The idea is to have <a href="view-source:http://w3future.com/html/loell/loell_core.js">
a small core</a> with a lot of power. For the rest I plan to use it to try out
new language ideas, which I usually get from 
<a href="http://lambda.weblogs.com">Lambda the Ultimate</a>.
The focus is on testing out language features that improve productivity,
like goal directed programming, helpful typing features, readability and building abstractions.</p>
<p>Try some code:</p>
<textarea id="oosample" style="display:none">
// implementation of the Complex prototype
Complex = <
  /** property definitions **/
  .r = Number<>
  .i = Number<>
  
  /** method definition **/
  .toString = {'' + .r + '+' + .i + 'i'}
  .makeComplex = {\value
    value isA Complex else Complex<.r = value; .i = 0>
  }
  .+ = {
    that = this makeComplex that
    Complex<
      .r = this.r + that.r
      .i = this.i + that.i
    >
  }
  .* = {
    that = this makeComplex that
    Complex<
      .r = this.r * that.r - this.i * that.i
      .i = this.r * that.i + this.i * that.r
    >
  }
>
// make a new complex number
i = Complex<.r = 0; .i = 1>
x = i*2+1
x toString
</textarea>
<textarea id="ifsample" style="display:none">
// implementation of while
// while is used as a method of the current scope
while = {\test
  $.whileScope = this
  <.do = {\code
    (#test) then {
      #code
      whileScope while test do code
    } else success
  }>
}
 
// implementation of until
// until is a method of closures
Closure.until = {\test
  #this
  (#test) else {
    this until test
  }
}
 
// testcode
a = 2
b = (1==2) then {a = 3} else {a = 4}
 
$while {a!=1} do {
  a -= 1
  b += 5
}
 
{
  a += 1
  b -= 4
} until {a==4}
 
b
</textarea>
<textarea id="shapesample" style="display:none">
Shape=<
  .x = Number<>
  .y = Number<>
  .moveTo = {\pos {.x isA Number gt 0; .y isA Number gt 0}
    .x = pos.x
    .y = pos.y
  }
  .rMoveTo = {\pos {.x isA Number; .y isA Number}
    .x += pos.x
    .y += pos.y
  }
>
 
Rectangle = Shape<
  .width = Number<>
  .height = Number<>
  .draw = {
    "Drawing a Rectangle at:(" + .x + "," + .y +
      "), width " + .width + ", height " + .height + "\n"
  }
>
 
Circle = Shape<
  .radius = Number<>
  .draw = {
    "Drawing a Circle at:(" + .x + "," + .y +
         "), radius " + .radius + "\n"
  }
>
 
result = ''
 
// create a collection containing various shape instances
scribble = [
  Rectangle<.x=10; .y=20; .width=5; .height=6>
  Circle<.x=15; .y=25; .radius=8>
]
 
// iterate through the collection and handle shapes polymorphically
scribble all {\ashape
   result += ashape draw
   ashape rMoveTo <.x=100; .y=100>
   result += ashape draw
}
 
// access a rectangle specific function
arectangle = Rectangle<
  .x=0; .y=0
  .width=15; .height=15
>
arectangle.width = 30
result += arectangle draw
</textarea>
<textarea id="fpsample" style="display:none">
// add support for 'currying' closures
Closure.using={\thatValue
  $.clos = this;
  {this (clos) thatValue}
}
 
// extend the List prototype
List {
  .foldr = {.hd; .hd (that) .tl foldr that}
         | {that.nilValue}
  .foldl = {
    this foldl2 <.f = that; .nilValue = that.nilValue>
  }
  .foldl2 = {
    .hd
    .tl foldl2 <
      .f = that.f
      .nilValue = that.nilValue (that.f) this.hd
    >
  } | {that.nilValue}
  .sum = .foldr using Number.+
  .product = .foldr using Number.*
}
  
// set values to be used with foldr and foldl
Number {
  .+.nilValue = 0
  .*.nilValue = 1
}
 
// example
a = 2 to 5
decimal = List.foldl using {this*10+that}<.nilValue = 0>
a (decimal) // == 2345
'sum: '+(a sum)+', product: '+(a product)
</textarea>
<textarea id="haskell" style="display:none">
Number.sign = {this gt 0;  1}
            | {this lt 0; -1}
            | 0
             
// test
// -3 sign
 
List {
  .zip = {!this.hd; []}
       | {!that.hd; []}
       | {[[this.hd; that.hd]] + (this.tl zip that.tl)}
 
  .qsort = {
    $.x = .hd
    $.elts_lt_x  = .tl some {that lt  x} qsort
    $.elts_gte_x = .tl some {that gte x} qsort
    elts_lt_x + [.hd] + elts_gte_x
  } | {[]}
}
  
// test
// [1;2] zip [3;4;5]
[1;4;3;3;1;2] qsort
</textarea>
<textarea id="recurse" style="display:none">
// default recursion closure is just the closure
Closure.recurse = {this}
 
fib_nr = {\n
  $.fib_nr = closure recurse
  (n lt 2) then 1 else {
    $ fib_nr (n-1) + $ fib_nr (n-2)
  }
}
 
// this is slow:
// $ fib_nr 13
 
// let the recursion closure cache the results
fib_nr_fast = fib_nr<
  .cache = <>
  .recurse = {
    $.fnf = this
    {\arg
      fnf.cache.(arg) else {fnf.cache.(arg) = $ fnf arg}
    }
  }
>
 
$ fib_nr_fast 13
</textarea>
<script>
function load(id) {document.getElementById('source').value=document.getElementById(id).value}
</script>
<ul>
<li><a href="#" onclick="load('oosample');return false">Load object oriented sample code</a></li>
<li><a href="#" onclick="load('fpsample');return false">Load functional programming sample code</a></li>
<li><a href="#" onclick="load('ifsample');return false">Load 'macro' sample code</a></li>
<li><a href="#" onclick="load('shapesample');return false">Load shapes sample code</a> 
(see <a href="http://www.angelfire.com/tx4/cus/shapes/">Chris Rathman's OO Shape Examples</a>)</li>
<li><a href="#" onclick="load('haskell');return false">Load Haskell-esque sample code</a>
(see <a href="http://www.haskell.org/">haskell.org</a>)</li>
<li><a href="#" onclick="load('recurse');return false">Load recursion overriding sample code</a>
(see <a href="http://lambda.weblogs.com/discuss/msgReader$5463">LtU discussion</a>)</li>
</ul>
<p style="clear:right">
<textarea style="width:95%;" rows="15" id="source">
</textarea>
<button onclick="run()">Compile and Run</button>
</p>
<div id="result"></div>
<h3>Core syntax</h3>
<dl>
<dt><code><i>exprs</i> <i>separator</i> <i>expr</i></code></dt>
<dd>First evaluates <code><i>exprs</i></code> and if that does not return <code>failure</code> then returns <code><i>expr</i></code>.
Valid expression separators are <code><b>;</b></code> and a new line, if the indentation on the new
line is not bigger than the indentation of the line of the start of the expression.</dd>
<dt><pre>
<i>expr</i><b>.(</b><i>exprs</i><b>)</b>
<i>expr</i><b>.(</b><i>exprs</i><b>) =</b> <i>expr</i>
</pre></dt><dd>Gets/sets a property.</dd>
<dt><code><b>{</b> <i>exprs</i> <b>}</b></code></dt>
<dd>Creates a closure, the current scope is stored in the <code>scope</code> property.</dd>
<dt><pre><i>expr</i> <b>#</b> <i>closure</i></pre></dt>
<dd>Evaluate a closure, using <code><i>expr</i></code> as scope.</dd>
<dt><code><i>expr</i> <b>&lt;</b> <i>exprs</i> <b>&gt;</b></code></dt><dd>
Creates a new object, using <code><i>expr</i></code> as prototype 
(stored in the <code>proto</code> property).
The current scope is stored in the <code>scope</code> property.
If <code><i>expr</i></code> is ommited, <code>Any</code> is used.
<code><i>exprs</i></code> is evaluated in the current scope,
but with <code>current</code> set the newly created object.</dd>
<dt><code><i>expr</i> <i>closure</i> <i>expr</i></code></dt><dd>Simulates a method call. (object method argument)
The closure is called with the scope it was defined in,
but with <code>this</code> set to the left value, 
and <code>that</code> set to the right value.</dd>
<dt><code><i>expr</i> <i>ident</i><b>=</b> <i>expr</i></code></dt><dd>A method call, where the object is set to the result.</dd>
<dt><code><b>$</b></code></dt><dd>The current scope.</dt>
<dt><pre>
<i>ident</i>
<i>ident</i> <b>=</b> <i>expr</i>
</pre></dt><dd>Gets/sets a property of the current scope</dd>
<dt><code><b>[</b> <i>exprs</i> <b>]</b></code></dt>
<dd>Creates a list, with for each expression an element with the value of that expression.</dd>
</dl>
<h3>Shortcut syntax</h3>
<dl>
<dt><pre>
<i>expr</i><b>.</b><i>ident</i> <b></b>
<i>expr</i><b>.</b><i>ident</i> <b>=</b> <i>expr</i>
</pre></dt><dd>Gets/sets a property.</dd>
<dt><pre>
<b>.</b><i>ident</i>
<b>.</b><i>ident</i> <b>=</b> <i>expr</i>
<b>.(</b><i>exprs</i><b>)</b>
<b>.(</b><i>exprs</i><b>) =</b> <i>expr</i>
</pre></dt><dd>Gets/sets a property of <code>this</code> inside a closure definition,
or of the <code>current</code> inside an object definition.</dd>
<dt><code><b>{</b> <b>\</b><i>ident</i> <i>separator</i> <i>exprs</i> <b>}</b></code></dt>
<dd>Creates a closure. The value of <code>that</code> is assigned to <code><i>ident</i></code>.
(This makes <code><i>ident</i></code> the argument name for methods)
The identifier may be extended to a test expression.</dd>
<dt><code><i>ident</i></code></dt><dd>Proper identifier tokens are: /[A-Za-z_][A-Za-z0-9_]*/, <code>==</code>, <code>!=</code> or any combination of <code>* + - & ^ ? | /</code></dd>
<dt><code><b>/*</b><i>...</i><b>*/</b> <b><a href="//">//</a></b><i>...</i></code></dt><dd>Javascript style comments are supported</dd>
</dl>
<h3>All objects</h3>
<p>These methods are defined:</p>
<dl>
<dt><code>==</code> <code>!=</code></dt><dd>test if it is (not) the same object</dd>
<dt><code>isA</code></dt><dd>test if the argument is a prototype of this object</dd>
<dt><code>then</code></dt><dd>Evaluates the argument if <code>this</code> is not <code>failure</code>.
Use a closure if you want short-circuiting. (similar to <code>&&</code> in Javascript)</dd>
<dt><code>else</code></dt><dd>Evaluates the argument if <code>this</code> is <code>failure</code>.
Use a closure if you want short-circuiting. (similar to <code>||</code> in Javascript)</dd>
</dl>
<h3>Lists</h3>
<p>These methods are defined:</p>
<dl>
<dt><code>+</code></dt><dd>list concatenation</dd>
<dt><code>item</code> <code><i>n</i></code></dt><dd>Get the <code><i>n</i></code>th item from the list.</dd>
<dt><code>all</code> <code><i>closure</i></code></dt>
<dd>Returns a new list by calling <code><i>closure</i></code> once for every item, 
passing each item as the argument to <code><i>closure</i></code>. 
The result of <code><i>closure</i></code> is used as the given item in the new list.
If a call fails, <code>all</code> fails.</dd>
<dt><code>some</code> <code><i>closure</i></code></dt>
<dd>Returns a new list by calling <code><i>closure</i></code> once for every item, 
passing each item as the argument to <code><i>closure</i></code>. 
The result of <code><i>closure</i></code> is used as the given item in the new list,
if the call succeeds. <code>some</code> can be used to filter a list.</dd>
</dl>
<h3>Closures</h3>
<p>These methods are defined:</p>
<dl>
<dt><code><i>closureA</i></code> <code>|</code> <code><i>closureB</i></code></dt>
<dd>Creates a new closure, that first calls <code><i>closureA</i></code>, 
then calls <code><i>closureB</i></code> if that fails.</dd>
</dl>
<h3>Strings</h3>
<p>The syntax is equivalent to javascript. These methods are defined:</p>
<dl>
<dt><code>+</code></dt><dd>string concatenation</dd>
<dt><code>==</code> <code>!=</code></dt><dd>test for (in)equality</dd>
</dl>
<h3>Numbers</h3>
<p>The syntax is equivalent to javascript. These methods are defined:</p>
<dl>
<dt><code>+</code> <code>-</code> <code>*</code> <code>/</code></dt><dd>arithmetic</dd>
<dt><code>lt</code> <code>gt</code></dt><dd>less than and greater than tests</dd>
<dt><code>==</code> <code>!=</code></dt><dd>test for (in)equality</dd>
</dl>
<h3>Booleans</h3>
<p>Loell has basic goal directed programming support.
True is <code>success</code> and false is <code>failure</code>.
Most test methods return <code>failure</code> when the test failes,
and <code>this</code> when the test succeeds.</p>
<dl>
<dt><code>!</code> <code><i>expr</i></code></dt><dd>not. 
Turns <code>failure</code> into <code>success</code>, and anything else into <code>failure</code>.</dd>
</dl><p>

</div>
	<div id="footer">&#x00A9; Copyright 2003 <a href="mailto:sjoerd@w3future.com">Sjoerd Visscher</a>, <a href="http://w3future.com/">w3future.com</a></div>
</div>
<script type='text/javascript'><!--
initButtons(true);initSectionTabs();initSidebarButtons();staticSiteStatsImage()
//--></script>
</body>
</html>
